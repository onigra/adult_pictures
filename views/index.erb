<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>Instaapp</title>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

    <link rel="shortcut icon" href="../favicon.ico"> 
    <link href="/AutomaticImageMontage/css/demo.css" rel="stylesheet" />
    <link href="/AutomaticImageMontage/css/style.css" rel="stylesheet" />
    <link href="/lightbox/css/lightbox.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow&v1' rel='stylesheet' />
    <link href='http://fonts.googleapis.com/css?family=Monoton' rel='stylesheet' />
    <script src="http://code.jquery.com/jquery.min.js"></script>
    <script src="/AutomaticImageMontage/js/jquery.montage.min.js"></script>
    <script src="/lightbox/js/lightbox.js"></script>
  </head>

  <body style="background:#000;">
    <div class="container">
      <div class="header">
        <a href="http://evening-sea-7671.herokuapp.com/"><span>&laquo; Instapp: </span>Â©Onigra</a>
        <span class="right_ab">
          <a href="https://github.com/onigra/"><strong>Contact</strong></a>
        </span>
      </div>

      <div class="am-container" id="am-container">
        <% @pictures.each do |i| %>
          <%= i %>
        <% end %>
      </div>
      <!-- <div id="loadmore" class="loadmore" style="width:100%;">load more...</div> --!>
    </div>

    <script type="text/javascript">
      $(function() {
        
        var $container   = $('#am-container'),
          $imgs    = $container.find('img').hide(),
          totalImgs  = $imgs.length,
          cnt      = 0;
        
        $imgs.each(function(i) {
          var $img  = $(this);
          $('<img/>').load(function() {
            ++cnt;
            if( cnt === totalImgs ) {
              $imgs.show();
              $container.montage({
                minw : 100,
                alternateHeight : true,
                alternateHeightRange : {
                  min  : 50,
                  max  : 350
                },
                margin : 8,
                fillLastRow : true
              });
              
              /* 
               * LOAD MORE:
              $('#overlay').fadeIn(500);
              var imgarr = new Array();
              for( var i = 1; i <= 20; ++i ) {
                imgarr.push( i );
              }

              $('#loadmore').show().bind('click', function() {
                var len = imgarr.length;
                for( var i = 0, newimgs = ''; i < 15; ++i ) {
                  var pos = Math.floor( Math.random() * len ),
                    src  = imgarr[pos];
                  newimgs  += '<a href="#"><img src="images/' + src + '.jpg"/></a>';
                }
                
                var $newimages = $( newimgs );
                $newimages.imagesLoaded( function(){
                  $container.append( $newimages ).montage( 'add', $newimages );
                });
              });
               */

            }
          }).attr('src',$img.attr('src'));
        });  
        
      });
    </script>

  </body>
</html>
